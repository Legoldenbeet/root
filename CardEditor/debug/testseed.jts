Program test;
var
  i: integer;
  s, s1: string;
Begin
  //if not jts.opened then //条件分支
    //jts.openPort('KOF_SOCKET');//尝试打开端口

  if jts.opened then begin
    jts.setNad($15);//如果是接触卡，可以注释本行
    jts.restart();//卡片复位
    jts.GP_Exauth(0);
    jts.senDisplay('80e40080074f05123456789Asw6a88/6a80/9000');
//INSTALL [for load]
    jts.senDisplay('80E602000A05123456789A00000000SW9000');
//LOAD [for 1 Block]
    jts.senDisplay('80E80000C8C482051F010036DECAFFED020204000105123456789A26636F6D2F7761746368646174612F746573745072697661746553656564416C676F726974686D02002100360021000A0020008E000E029600B6009B0000010105B70008000400A003010004002003020107A0000000620101000108A000000227011000020107A000000062010203000A0106123456789A01000106000E000000800306000507010000005C0702960004308F0009181D1E8C00107A0540188C0017181030900B8703181060048D00198702SW9000');
//LOAD [for 2 Block]
    jts.senDisplay('80E80001C8181063048D00198701181066038D0016870518106B110080038D0007940000228700AD007B000A038E0300220518191E0441191E258B00067A0722188B000B60037A0331198B00132E1B04257302200020002600150021006E00CF0130019101CF8D001898020E8D001FA80208198B001B3B181B08258904AD02AD00058B000CAD027B001E03AF04AD03038B001D31AD027B001EAF041030AF0443AD031E8B00153BAD03037B00200310308D00129801C4119B018D001CA801BB198B001B3B181B08258904AD01ADSW9000');
//LOAD [for 3 Block]
    jts.senDisplay('80E80002C800058B000CAD017B001E03AF04AD03038B001D31AD017B001EAF041030AF0443AD031E8B00153B198B00113B1910308B001419AD030310308B0008AD03037B000D0310308D0012980163119B018D001CA8015A198B001B3B181B08258904AD02AD00048B000CAD027B002003AF04AD03038B001D31AD027B0020AF041030AF0443AD031E8B00153B198B00113B1910308B001419AD030310308B0008AD03037B001E0310308D0012980102119B018D001CA800F9198B001B3B181B08258904AD01AD00048B000CADSW9000');
//LOAD [for 4 Block]
    jts.senDisplay('80E80003C8017B000D03AF04AD03038B001D31AD017B000DAF041030AF0443AD031E8B00153B198B00113B1910308B001419AD030310308B0008AD03037B001E0310308D00129800A1119B018D001CA80098198B001B3B181B08258904AD05AD00078B001AAD057B001E03AF048B000FAD057B001EAF041030AF04437B0020102010108B00216161119B018D001C7059AD05AD00068B001AAD057B001E03AF048B000FAD057B001EAF041030AF0443AD03038B000E3B198B00113B1910108B001419AD030310108B0008AD0303SW9000');
//LOAD [for 5 Block]
    jts.senDisplay('80E80004C87B0020102010108D00126010119B018D001C7008116D008D001C7A0800B600080004000403001028DBC3BC49FFD87DCFA509B11D422BE70300309B9B7BFCD1813CB95D0B3618F40F5122229EE88A385517170CFEE7CF4CCB451A345B87CDECBF0F70353CCCB6CE3580290300309B9B7BFCD1813CB95D0B3618F40F51229B9B7BFCD1813CB95D0B3618F40F51229B9B7BFCD1813CB95D0B3618F40F5122030030B41E6BE2EBA84A148E2EED84593C5EC7B41E6BE2EBA84A148E2EED84593C5EC7B41E6BE2EBA84A14SW9000');
//LOAD [for 6 Block]
    jts.senDisplay('80E80005C88E2EED84593C5EC70000000005008E0023020002030200020102000200020002040200020502000202038003020681020003800A050100020005000000038003030381040305000004038103060381030A0600000D03800A070680100003800A0103800A0903810401068103000680030006800811068104000381030403800A060680070103810404050000060680081205000002038103070181010009009B00471909090910025402020606020705040307210202060602070504031308210202060602070504SW9000');
//LOAD [for Last Block]
    jts.senDisplay('80E880067303130821020206060207050403130821020206060505041702060605050403130800500406070E09090C0407050C07091C06070F0509060D070609070F0509060D050709060609070F0509060D050709060609070F0509060D050709060609070F0506050A07080A0506050D05070906070808SW9000');
//INSTALL [for install]
    jts.senDisplay('80E60C001A05123456789A06123456789A0106123456789A01010002C90000SW9000');

    
    jts.senDisplay('00A4040006123456789a01');
    
    for i:=0 to 48    do
    begin
    show('counter:='+format('%.2x',[i]));
    jts.senDisplay('8020000000');
    //seed 加密CBC 
    jts.senDisplay('8021000001'+format('%.2x',[i]));
    //seed 加密ECB 
    jts.senDisplay('8022000001'+format('%.2x',[i]));
    //解密CBC 
    jts.senDisplay('8023000001'+format('%.2x',[i]));
    //解密ECB 
    jts.senDisplay('8024000001'+format('%.2x',[i]));
    //verify 
    jts.senDisplay('8025000001'+format('%.2x',[i]));
    //签名 
    jts.senDisplay('8026000001'+format('%.2x',[i]));
    end;
    jts.senDisplay('RST');

    jts.closePort();//关闭端口
  end;
End.

